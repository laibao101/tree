<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>

        var mock = [
            { "id": 0, "name": "root", "pid": -1 },
            { "id": 1, "name": "总部", "pid": 0 },
            { "id": 6, "name": "工程部", "pid": 1 },
            { "id": 7, "name": "工程部1", "pid": 6 },
            { "id": 8, "name": "工程部2", "pid": 7 },
            { "id": 9, "name": "工程部3", "pid": 8 },
            { "id": 10, "name": "测试部", "pid": 1 },
            { "id": 11, "name": "测试部1", "pid": 10 },
            { "id": 12, "name": "测试部2", "pid": 11 },
            { "id": 13, "name": "生产部", "pid": 1 },
            { "id": 14, "name": "规划部", "pid": 1 },
            { "id": 15, "name": "市场部", "pid": 1 },
        ];
        function Children() {
            this.list = [];
        }

        Children.prototype.addChild = function (node) {
            this.list.push(node);
        }

        function Node() {
            this.id;
            this.name;
            this.pid;
            this.parentNode = null;
            this.visible = true;
            this.children = new Children();
        }

        Node.prototype.addChild = function (node) {
            this.children.addChild(node);
        }

        function MultipleTree(config) {
            var conf = config;
            this.data = conf.data;
            this.root = this.init(conf);
        }

        MultipleTree.prototype.init = function (conf) {
            var dataList = this.data;
            var nodeList = [];
            // 根节点
            var root = new Node();
            // 根据结果集构造节点列表（存入散列表）
            for (var i in dataList) {
                var value = dataList[i];
                var node = new Node();
                node.id = value['id'];
                node.name = value['name'];
                node.pid = value['pid'];
                nodeList[node.id] = node;
            }
            for (var i in nodeList) {
                var node = nodeList[i];
                if (conf.rootId == node.id) {
                    root = node;
                } else {
                    nodeList[node.pid].addChild(node);
                    node.parentNode = nodeList[node.pid];
                }
            }
            return root;
        }

        var config = {
            data: mock,
            rootId: 0
        }
        var mul = new MultipleTree(config);

        console.log(mul);

        var mock1 = [
            { id: 0, pid: -1, name: "随意勾选 1", open: true },
            { id: 1, pid: 0, name: "随意勾选 1", open: true },
        { id: 11, pid: 1, name: "随意勾选 1-1", open: true },
        { id: 111, pid: 11, name: "随意勾选 1-1-1" },
        { id: 112, pid: 11, name: "随意勾选 1-1-2" },
        { id: 12, pid: 1, name: "随意勾选 1-2", open: true },
        { id: 121, pid: 12, name: "随意勾选 1-2-1" },
        { id: 122, pid: 12, name: "随意勾选 1-2-2" },
        { id: 2, pid: 0, name: "随意勾选 2", checked: true, open: true },
        { id: 21, pid: 2, name: "随意勾选 2-1" },
        { id: 22, pid: 2, name: "随意勾选 2-2", open: true },
        { id: 221, pid: 22, name: "随意勾选 2-2-1", checked: true },
        { id: 222, pid: 22, name: "随意勾选 2-2-2" },
        { id: 23, pid: 2, name: "随意勾选 2-3" }];


        var config1 = {
            data: mock1,
            rootId: 0
        }

        var mul1 = new MultipleTree(config1);
        console.log(mul1);
    </script>
</body>

</html>